<!DOCTYPE html>
<html>
<head>
    <title>Image Search Demo</title>
</head>
<body style="font-family: Arial; padding: 30px;">

    <h2>Search for an Image</h2>

    <input id="inputBox" placeholder="Type something like 'tom'" 
           style="width: 300px; padding: 8px;">
           
    <button onclick="searchImage()" style="padding: 8px;">Show Image</button>
    <br><br>

    <h4 style="margin: 0; margin-bottom: 5px;">Upload an Image</h4>
    <input type="file" id="imageUpload" style="display: block; margin-bottom: 8px;">
    <input type="text" id="imageName" placeholder="Enter name for file" style="width: 200px; padding: 3px;">
    <button onclick="uploadImage()" style="padding: 3px">Upload Image</button>

    <br><br>

    <p id="message"></p>
    <img id="imgBox" width="300" style="border: 1px solid #ccc;">

    <script>
        function searchImage() {
            let text = document.getElementById("inputBox").value;

            //text = jerry
            //localhost:3000/api/getImage?name=jerry
            fetch(`/api/getImage?name=${encodeURIComponent(text)}`)
            .then(res => res.json())
            .then(data => {
                document.getElementById("imgBox").src = data.url;
            });
        }
        async function uploadImage() { 
            let file = document.querySelector('#imageUpload').files[0];
            const filename = document.querySelector('#imageName').value;

            let formData = new FormData();
            formData.append('image', file);

            await fetch(`/api/upload?name=${filename}`, {
                method: 'POST',
                body: formData
            })
            .then(res => res.json())
            .then(data => {
                console.log(data);
                const message = document.querySelector("#message");
                message.innerHTML = `${filename} has been successfully added`;
            });
        }
    </script>

</body>
</html>
